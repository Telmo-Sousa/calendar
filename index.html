<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Calendar Generator</title>
    <link rel="stylesheet" href="styles.css">
  </head>
  <body>
    <div class="container">
      <h1>Work Schedule Calendar Generator</h1>
      
      <div class="tabs">
        <button class="tab-btn active" data-tab="manual">Manual Entry</button>
        <button class="tab-btn" data-tab="csv">CSV Import</button>
        <button class="tab-btn" data-tab="excel">Excel Converter</button>
      </div>
      
      <div id="manual-tab" class="tab-content active">
        <div class="instructions">
          <h3>Instructions:</h3>
          <p>1. Select the year and month for your schedule</p>
          <p>2. Choose the shift code for each day of the month</p>
          <p>3. Click "Generate Calendar" to create and download your .ics file</p>
        </div>
        
        <div class="shift-legend">
          <div class="shift-item">1 → 09:45 - 19:00</div>
          <div class="shift-item">2 → 14:00 - 23:00</div>
          <div class="shift-item">5 → 11:30 - 20:30</div>
          <div class="shift-item">folga → Day Off</div>
          <div class="shift-item">ferias → Vacation</div>
        </div>
        
        <div class="year-selector">
          <button id="prev-year">◀</button>
          <span id="current-year">2024</span>
          <button id="next-year">▶</button>
        </div>
        
        <div class="month-selector" id="month-selector">
        </div>
        
        <div id="schedule-container">
          <div class="schedule-grid" id="schedule-grid">
          </div>
        </div>
        
        <button class="generate" id="generate">Generate Calendar</button>
        
        <div id="result"></div>
      </div>
      
      <div id="csv-tab" class="tab-content">
        <div class="instructions">
          <h3>CSV Import Instructions:</h3>
          <p>1.  Upload your CSV schedule file OR paste your CSV data in the text area below</p>
          <p>2.  Enter the name of the person whose schedule you want to extract</p>
          <p>3.  Click "Generate Calendar" to create and download the .ics file</p>
        </div>
      
        <div class="form-group">
          <label for="csv-file">Upload CSV File:</label>
          <input type="file" id="csv-file" accept=".csv" />
        </div>
      
        <div class="form-group">
          <label for="csv-data">Paste CSV Data:</label>
          <textarea
            id="csv-data"
            placeholder="Paste your CSV schedule data here..."
            rows="10"
          ></textarea>
        </div>
      
        <div class="form-group">
          <label for="person-name">Person Name:</label>
          <input type="text" id="person-name" placeholder="e.g., Telmo Sousa" />
        </div>
      
        <div class="form-group">
          <label for="year-input">Year (if not specified in CSV):</label>
          <input
            type="number"
            id="year-input"
            placeholder="e.g., 2025"
            value="2025"
          />
        </div>
      
        <button class="generate" id="generate-from-csv">Generate Calendar</button>
      
        <div id="csv-result"></div>
      </div>
      
      <div id="excel-tab" class="tab-content">
        <div class="instructions">
          <h3>Excel to CSV Converter:</h3>
          <p>1. Upload your Excel file (.xlsx or .xls)</p>
          <p>2. The converter will process the file and display the CSV output</p>
          <p>3. Copy the CSV data to use in the CSV Import tab</p>
        </div>
        
        <div class="form-group">
          <label for="excel-file">Upload Excel File:</label>
          <input type="file" id="excel-file" accept=".xlsx, .xls">
        </div>
        
        <div class="form-group">
          <label for="sheet-select">Select Sheet:</label>
          <select id="sheet-select" disabled>
            <option value="">First load an Excel file...</option>
          </select>
        </div>
        
        <button class="generate" id="convert-excel" disabled>Convert to CSV</button>
        
        <div class="form-group" id="csv-output-container" style="display: none;">
          <label for="csv-output">CSV Output:</label>
          <textarea id="csv-output" rows="15" readonly></textarea>
          <button class="copy-btn" id="copy-csv">Copy to Clipboard</button>
          <button class="copy-btn" id="use-in-csv-tab">Use in CSV Import Tab</button>
        </div>
        
        <div id="excel-result"></div>
      </div>
    </div>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="script.js"></script>
    <script src="excel-converter.js"></script>
  </body>
</html>
